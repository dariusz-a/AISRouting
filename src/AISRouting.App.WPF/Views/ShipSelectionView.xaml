<UserControl x:Class="AISRouting.App.WPF.Views.ShipSelectionView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:converters="clr-namespace:AISRouting.App.WPF.Converters">
    
    <UserControl.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </UserControl.Resources>

    <StackPanel Margin="10">
        
        <!-- Input Folder Selection -->
        <GroupBox Header="Input Folder" Margin="0,0,0,10">
            <Grid Margin="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBox Grid.Column="0" 
                         Text="{Binding InputFolderPath, Mode=OneWay}"
                         IsReadOnly="True"
                         VerticalAlignment="Center"
                         Margin="0,0,10,0"/>
                
                <Button Grid.Column="1"
                        Content="Browse..."
                        Command="{Binding SelectInputFolderCommand}"
                        Width="100"
                        AutomationProperties.AutomationId="browse-button"
                        AutomationProperties.Name="Browse for Input Folder"/>
            </Grid>
        </GroupBox>

        <!-- Error Message -->
        <TextBlock Text="{Binding ErrorMessage}"
                   Foreground="Red"
                   FontWeight="Bold"
                   Margin="0,0,0,10"
                   Visibility="{Binding ErrorMessage, Converter={StaticResource BoolToVisibilityConverter}}"
                   AutomationProperties.AutomationId="input-error"
                   AutomationProperties.Name="Input Root Error"/>

        <!-- Vessel Selection -->
        <GroupBox Header="Vessel Selection" Margin="0,0,0,10">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Vessel ComboBox -->
                <Grid Grid.Row="0" Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" 
                               Text="Select Vessel:" 
                               VerticalAlignment="Center" 
                               Margin="0,0,10,0"/>
                    
                    <ComboBox Grid.Column="1"
                              ItemsSource="{Binding AvailableVessels}"
                              SelectedItem="{Binding SelectedVessel}"
                              DisplayMemberPath="DisplayName"
                              IsEnabled="{Binding IsInputRootValid}"
                              AutomationProperties.AutomationId="ship-combo"
                              AutomationProperties.Name="Select Vessel"/>
                </Grid>

                <!-- Static Data Display -->
                <GroupBox Grid.Row="1" Header="Ship Static Data">
                    <TextBox Text="{Binding StaticDataDisplay, Mode=OneWay}"
                             IsReadOnly="True"
                             TextWrapping="Wrap"
                             VerticalScrollBarVisibility="Auto"
                             Height="120"
                             FontFamily="Consolas"
                             AutomationProperties.AutomationId="ship-static"
                             AutomationProperties.Name="Ship Static Data"/>
                </GroupBox>
            </Grid>
        </GroupBox>

        <!-- Time Interval Selection -->
        <GroupBox Header="Time Interval Selection" Margin="0,0,0,10">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="150"/>
                </Grid.ColumnDefinitions>

                <!-- Start Time -->
                <TextBlock Grid.Row="0" Grid.Column="0" 
                           Text="Start Time:" 
                           VerticalAlignment="Center" 
                           Margin="0,0,10,0"/>
                <DatePicker Grid.Row="0" Grid.Column="1" 
                            SelectedDate="{Binding StartDate, Mode=TwoWay}"
                            Margin="0,0,10,0"
                            AutomationProperties.AutomationId="start-picker"
                            AutomationProperties.Name="Start Date"/>
                <TextBlock Grid.Row="0" Grid.Column="2" 
                           Text="Time:" 
                           VerticalAlignment="Center" 
                           Margin="0,0,10,0"/>
                <TextBox Grid.Row="0" Grid.Column="3"
                         Text="{Binding StartTimeString, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         AutomationProperties.AutomationId="start-time-picker"
                         AutomationProperties.Name="Start Time"/>

                <!-- Stop Time -->
                <TextBlock Grid.Row="1" Grid.Column="0" 
                           Text="Stop Time:" 
                           VerticalAlignment="Center" 
                           Margin="0,10,10,0"/>
                <DatePicker Grid.Row="1" Grid.Column="1" 
                            SelectedDate="{Binding StopDate, Mode=TwoWay}"
                            Margin="0,10,10,0"
                            AutomationProperties.AutomationId="stop-picker"
                            AutomationProperties.Name="Stop Date"/>
                <TextBlock Grid.Row="1" Grid.Column="2" 
                           Text="Time:" 
                           VerticalAlignment="Center" 
                           Margin="0,10,10,0"/>
                <TextBox Grid.Row="1" Grid.Column="3"
                         Text="{Binding StopTimeString, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         Margin="0,10,0,0"
                         AutomationProperties.AutomationId="stop-time-picker"
                         AutomationProperties.Name="Stop Time"/>

                <!-- Validation Message -->
                <TextBlock Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="4"
                           Text="{Binding ValidationMessage}"
                           Foreground="Red"
                           FontWeight="Bold"
                           Margin="0,10,0,0"
                           Visibility="{Binding ValidationMessage, Converter={StaticResource BoolToVisibilityConverter}}"
                           AutomationProperties.AutomationId="time-error"
                           AutomationProperties.Name="Time Range Validation Error"/>

                <!-- Create Track Button -->
                <Button Grid.Row="3" Grid.Column="3"
                        Content="Create Track"
                        HorizontalAlignment="Right"
                        Width="150"
                        Height="35"
                        Margin="0,15,0,0"
                        Command="{Binding CreateTrackCommand}"
                        AutomationProperties.AutomationId="create-track-button"
                        AutomationProperties.Name="Create Track"/>
            </Grid>
        </GroupBox>

    </StackPanel>
</UserControl>
