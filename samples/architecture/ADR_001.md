# ADR-001: Adopt Capability‑Aligned Micro Frontends (API‑Ready)
- **Status:** Proposed
- **Date:** 2025-10-22
## **Context:**  
Evidence Links: Context → [design_doc_v1_0.md § C4 Context View], [design_doc_v1_0.md § SLOs & Capacity Assumptions], [design_doc_v1_0.md § Assumptions & Open Questions]
- Business goals / scope  
	Deliver enterprise-ready Roles/Skills/People/Projects management with scalable governance (OIDC/RBAC), reliable UX, CSV import, and maintainable Vue 3 codebase; keep a viable path from current client-only scope to API-backed evolution.  
- Key QAs & constraints (top 3 with targets)  
	1) Latency: shell FCP ≤ 1.5 s p95; capability route change ≤ 250 ms p95; role CRUD ≤ 250 ms p95 end-to-end with SWR/optimistic updates.  
	2) Availability/HA: ≥ 99.95% monthly (CDN + HA API); graceful degradation per MFE when API is impaired.  
	3) Consistency: Backend = SoT; cache staleness window 1–5 s; revalidation p95 ≤ 1 s after mutation; idempotent APIs.  
- Assumptions (knowns/unknowns)  
	Knowns: Vue 3 + Vite + TypeScript + PrimeVue; Pinia for state; Playwright E2E; team size modest. Unknowns: API timeline/provider, SSO/IdP choice, tenant model for uniqueness, authoritative skills catalog, final CSV schema.
## **Decision:**  
Evidence Links: Decision → [design_doc_v1_0.md § C4 Container View], [design_doc_v1_0.md § Deployment Topology]
- Selected alternative and short description  
	Select Candidate B — capability‑aligned micro frontends composed in a shell with a typed data-access SDK; initial mock provider allowed, production provider targets REST/GraphQL with OIDC and server-side RBAC/policy.  
- Key design elements (patterns, data/consistency mode, deployment posture)
	Patterns: MFEs per capability, shared design system/router, SDK contracts; Data: backend SoT, SWR cache with optimistic updates and short TTL; Deployment: CDN-cached shell + independently deployable MFEs, HA API behind OIDC, feature flags for rollout.
## **Consequences:**  
Evidence Links: Consequences → [design_doc_v1_0.md § Risks & Mitigations], [design_doc_v1_0.md § SLOs & Capacity Assumptions]
- Positive outcomes (how it meets QAs)  
	Meets enterprise consistency/HA/security via centralized API+OIDC; scales teams with independent deploys; preserves UX with optimistic updates to hit p95 ≤ 250 ms; clear adapter path from mock to real API.  
- Trade-offs / liabilities (new risks introduced)  
	Increased architectural complexity, contract drift risk, higher CI/CD and observability costs, potential network latency regressions; requires coordination and versioning across MFEs and SDKs.  
- Operability & observability notes (SLOs, telemetry, rollout)
	SLOs: Availability ≥ 99.95%; route change ≤ 250 ms p95; CRUD ≤ 250 ms p95; error rate < 1% p95; cache revalidate ≤ 1 s p95. Telemetry: structured logs, web-vitals, distributed tracing from shell→API; dashboards with SLO burn rates. Rollout: canary per MFE, feature flags, blue/green on API, chaos drills for partial failures.
## **Alternatives Considered:**  
Evidence Links: Alternatives → [alt_arch_matrix.md rows Consistency, Scalability, Security/Compliance]
- Alt-A: Why compelling; decisive reason rejected  
	Compelling for speed/cost and excellent local latency (no network). Rejected for long-term due to cross-user consistency limits, browser storage quotas, and weak enterprise auth/audit posture.  
- Alt-B: Why compelling; decisive reason rejected
	Event-driven offline-first client is compelling for offline UX and full audit trail. Rejected due to modeling/sync complexity and team learning curve; offline-first isn’t a primary requirement today.
## **Links & Evidence:**  
- QA/Constraints  
	docs/tech_design/architecture/ocr.md  
- Trade-off matrix  
	docs/tech_design/architecture/alt_arch_matrix.md  
- Diagrams (C4/Deployment)  
	TBD  
- Risk table 
	docs/tech_design/architecture/ocr.md (Risks & Assumptions)  
- SLO draft
	This ADR (Consequences) and selected_winner.md QA posture
## **Open Questions:**  
- Is role-name uniqueness global or per tenant, and how is tenant context represented in client and API?  
- What is the authoritative skills/categories catalog and ID stability across imports?  
- CSV schema: required/optional columns, delimiter/encoding, and upsert vs create-only semantics.  
- Which IdP (OIDC) and RBAC policy model will be used; how are claims mapped to MFEs?  
- What is the API go-live timeline and interim mock strategy (adapter boundaries, test data)?  
- What rate limits and error budgets apply to CRUD and import flows; how are SLO breaches surfaced?  
- C4 and deployment diagrams for shell/MFEs/API boundary (TBD).  
- Data retention/export policy to mitigate browser storage risks during transition from client-only mock to API.  
- Contract testing scope between SDK and API; versioning policy to prevent breaking MFEs.
